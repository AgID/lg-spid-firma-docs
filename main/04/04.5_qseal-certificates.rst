.. _`Â§4.5`:

Certificati di sigillo elettronico qualificato
==============================================

SP e IdP si dotano, presso un :ref:`QTSP <QTSP>`, di un certificato elettronico
qualificato per la creazione di sigilli elettronici. Tali certificati
sono resi disponibili nei metadata SPID.

Detti certificati qualificati sono conformi alle raccomandazioni emanate
con le *LL.GG. sui certificati elettronici* (:ref:`cit. <llgg certificati>`) e contengono le seguenti
informazioni aggiuntive:

1. Il campo :code:`SubjectDN`, contenente i seguenti attributi:

   a. :code:`serialNumber` (`á´Éªá´… 2.5.4.5 <http://http/oid-info.com/get/2.5.4.5>`__) â€” valorizzato,
      sia per gli IdP che per i SP, in base alle alternative esposte al
      seguente ordine:

      -  la partita IVA indicata con il prefisso â€˜``VAT``â€™, come
         prescritto dal Â§5.1.4 punto 1 della norma ETSI `EN
         319-412-1 <http://www.etsi.org/deliver/etsi_en/319400_319499/31941201/01.01.01_60/en_31941201v010101p.pdf>`__
         (es. â€œ``VATIT-12345678901``â€);

      -  il codice fiscale indicato con il prefisso â€˜``CF:``â€™, come
         prescritto dal Â§5.1.4 punto 3 della suddetta norma (es. â€œ``CF:IT-01234567890``â€);

      -  il numero assegnato dal Registro Imprese, indicato con il
         prefisso â€˜``NTR``â€™, come prescritto dal Â§5.1.4 punto 2 della suddetta norma
         (es. â€œ``NTRIT-1234567890``â€);

      -  per gli SP pubblici, il codice IPA, cosÃ¬ come risulta nel campo
         :code:`ipaEntityCode` del registro SPID, preceduto dal prefisso
         â€˜``PA:``â€™, come prescritto dal Â§5.1.4 punto 3 della suddetta norma
         (es. â€œ``PA:IT-agid``â€).

   b. :code:`commonName` (`á´Éªá´… 2.5.4.3 <http://http/oid-info.com/get/2.5.4.3>`__) â€” contenente,
      mediante un elemento di tipo :code:`dNSName`, il nome di dominio â€“
      privo di qualsiasi carattere *wildcard* â€“ di cui al punto 5.

2. Il campo :code:`CertificatePolicies` (`á´Éªá´… 2.5.29.32 <http://http/oid-info.com/get/2.5.29.32>`__), contenente i
   seguenti attributi:

   a. :code:`PolicyIdentifier` â€” valorizzato come:

      -  :code:`spidSignature` (`á´Éªá´… 1.3.76.16.4.11 <http://http/oid-info.com/get/1.3.76.16.4.11>`__);

   b. una limitazione dâ€™uso indicata mediante la presenza di un campo
      :code:`userNotice` (`á´Éªá´… 2.5.29.49 <http://http/oid-info.com/get/ğŸ¸.ğŸ».ğŸ¸ğŸ¿.49>`__), di tipo
      :code:`explicitText`, valorizzato con la seguente stringa bilingue:
      â€œ``Certificato usabile solo per il processo di sottoscrizione di cui all'art.20 del CAD/This certificate may be used only for digital subscription pursuant to Digital Administration Code, art.20.``â€.

3. :code:`keyUsage` (`á´Éªá´… 2.5.29.15 <http://http/oid-info.com/get/ğŸ¸.ğŸ».ğŸ¸ğŸ¿.15>`__) â€” contenente
   i valori :code:`digitalSignature` e :code:`keyEncipherment`, cioÃ¨ i bit #0 e #2, valorizzati a ``1``,
   come da specifica :RFC:`5280`.

4. :code:`extendedKeyUsage` (`á´Éªá´… 2.5.29.16 <http://http/oid-info.com/get/2.5.29.16>`__) â€” contenente
   sia lâ€™elemento :code:`id-kp-serverAuth` (`á´Éªá´… 1.3.6.1.5.5.7.3.1 <http://http/oid-info.com/get/1.3.6.1.5.5.7.3.1>`__)
   che lâ€™elemento :code:`id-kp-clientAuth` (`á´Éªá´… 1.3.6.1.5.5.7.3.2 <http://http/oid-info.com/get/1.3.6.1.5.5.7.3.2>`__).

5. :code:`subjectAltName` (`á´Éªá´… 2.5.29.17 <http://http/oid-info.com/get/2.5.29.17>`__) â€” valorizzata
   con elemento unico di tipo :code:`dNSName` e contenente il dominio
   dellâ€™URL completo (cosÃ¬ come riportato nel registro SPID) presso il
   quale lâ€™ente federato rende disponibile, agli enti federati della
   tipologia opposta, il servizio di trasferimento sicuro di cui al
   :ref:`Â§5.2 <Â§5.2>`.

.. discourse::

:topic_identifier: 666
